"""
====================================================================================================
CFD-Based Analysis of Nonlinear Aeroelastic Behavior of High-Aspect Ratio Wings

M. J. Smith, M. J. Patil, D. H. Hodges

Georgia Institute fo Technology, Atlanta

====================================================================================================

Comparisson of the results obtained by in the paper above with those generated by the tool developed
in this work

Author: Jo√£o Paulo Monteiro Cruvinel da Costa
"""

# ==================================================================================================
# IMPORTS

import numpy as np

# Import code sub packages
from context import flyingcircus
from flyingcircus import geometry as geo
from flyingcircus import structures as struct

# ==================================================================================================
# GEOMETRY DEFINITION

# Wing section

# Aifoil name, only informative
naca0015 = "NACA 0015"

# Material properties, all equal to one as Smith et al only provies the stiffness characteristics
# of the wing
MATERIAL = struct.objects.Material(
    name="Spring Steel",
    density=7.6e3,
    elasticity_modulus=230e9,
    rigidity_modulus=89.3e9,
    poisson_ratio=0.25,
    yield_tensile_stress=350e6,
    ultimate_tensile_stress=420e6,
    yield_shear_stress=0,
    ultimate_shear_stress=0,
)

# Wing section properties
WING_SECTION = geo.objects.Section(
    identifier=naca0015,
    material=MATERIAL,
    area=8.0142e-6,
    Iyy=8.679e-13,
    Izz=3.301e-11,
    J=3.117e-12,
    shear_center=0.5,
)

# --------------------------------------------------------------------------------------------------

# Wing surface

WING_ROOT_CHORD = 0.06
WING_TIP_CHORD = 0.06
SEMI_WING_LENGTH = 0.487
WING_SWEEP_ANGLE = 0
WING_DIHEDRAL = 0
WING_TIP_TORSION_ANGLE = 0


# Definition of the wing planform
wing_surface = geo.objects.Surface(
    identifier="main_wing",
    root_chord=WING_ROOT_CHORD,
    root_section=WING_SECTION,
    tip_chord=WING_TIP_CHORD,
    tip_section=WING_SECTION,
    length=SEMI_WING_LENGTH,
    leading_edge_sweep_angle_deg=WING_SWEEP_ANGLE,
    dihedral_angle_deg=WING_DIHEDRAL,
    tip_torsion_angle_deg=WING_TIP_TORSION_ANGLE,
    control_surface_hinge_position=None,
)

# Creation of the wing macrosurface
wing = geo.objects.MacroSurface(
    position=np.array([0, 0, 0]),
    incidence=0,
    surface_list=[wing_surface],
    symmetry_plane=None,
    torsion_center=0.5,
)

# --------------------------------------------------------------------------------------------------

# Aircraft definition

changchuan_wing = geo.objects.Aircraft(
    name="Changchuan Wing",
    macrosurfaces=[wing],
    inertial_properties=geo.objects.MaterialPoint(),
    ref_area=(WING_ROOT_CHORD + WING_TIP_CHORD) * SEMI_WING_LENGTH,
    mean_aero_chord=WING_ROOT_CHORD
)
